{"level":"error","message":{"error":{"message":"Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:113:18\n    at Array.forEach (<anonymous>)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:110:44\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at jsonParser (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/types/json.js:100:7)\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)"},"request":{"ip":"127.0.0.1","method":"HEAD","url":"/health"}},"timestamp":"2025-09-30 17:40:27"}
{"level":"error","message":{"error":{"message":"Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:113:18\n    at Array.forEach (<anonymous>)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:110:44\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)"},"request":{"ip":"127.0.0.1","method":"POST","url":"/api/v1/auth/login"}},"timestamp":"2025-09-30 17:40:43"}
{"level":"error","message":{"error":{"message":"Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:113:18\n    at Array.forEach (<anonymous>)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/express-mongo-sanitize/index.js:110:44\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)"},"request":{"ip":"127.0.0.1","method":"POST","url":"/api/v1/auth/login"}},"timestamp":"2025-09-30 17:46:46"}
{"level":"error","message":"Sanitizer error: Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/middleware/sanitizer.js:23:21\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:238:16)\n    at done (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:227:7)","timestamp":"2025-09-30 17:48:36"}
{"level":"error","message":"Sanitizer error: Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/middleware/sanitizer.js:23:21\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:238:16)\n    at done (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:227:7)","timestamp":"2025-09-30 17:51:12"}
{"level":"error","message":"jwt malformed","name":"JsonWebTokenError","stack":"JsonWebTokenError: jwt malformed\n    at module.exports [as verify] (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/jsonwebtoken/verify.js:70:17)\n    at TokenService.rotateRefreshToken (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/services/tokenService.js:65:27)\n    at refreshToken (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/controllers/authController.js:154:43)\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/route.js:157:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/middleware/validation/validator.js:22:9\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","timestamp":"2025-09-30 17:51:12"}
{"level":"error","message":{"error":{"code":"AUTH_ERROR","message":"Invalid or expired refresh token","stack":"Error: Invalid or expired refresh token\n    at refreshToken (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/controllers/authController.js:164:15)\n    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)","statusCode":401},"request":{"ip":"127.0.0.1","method":"POST","url":"/api/v1/auth/refresh"}},"timestamp":"2025-09-30 17:51:12"}
{"level":"error","message":"Sanitizer error: Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/middleware/sanitizer.js:23:21\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:238:16)\n    at done (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:227:7)","timestamp":"2025-09-30 17:51:25"}
{"level":"error","message":"Sanitizer error: Cannot set property query of #<IncomingMessage> which has only a getter","stack":"TypeError: Cannot set property query of #<IncomingMessage> which has only a getter\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/src/middleware/sanitizer.js:23:21\n    at Layer.handleRequest (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/lib/layer.js:152:17)\n    at trimPrefix (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:342:13)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:297:9\n    at processParams (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:582:12)\n    at next (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/router/index.js:291:5)\n    at /Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/body-parser/lib/read.js:132:5\n    at AsyncResource.runInAsyncScope (node:async_hooks:214:14)\n    at invokeCallback (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:238:16)\n    at done (/Users/macbookpro/Desktop/verichain/verichain-v2/backend/node_modules/raw-body/index.js:227:7)","timestamp":"2025-09-30 17:53:01"}
{"details":null,"level":"error","message":"API Error: INTERNAL_ERROR - 2FA setup expired. Please start again","request_id":"3ca042f4-535f-4eb0-8238-e97840e35092","status":400,"timestamp":"2025-09-30 21:39:44"}
{"details":null,"level":"error","message":"API Error: INTERNAL_ERROR - Invalid 2FA token","request_id":"78c59610-0fbf-4efd-a613-bdb97bdfe4cd","status":400,"timestamp":"2025-09-30 21:40:54"}
{"details":null,"level":"error","message":"API Error: INTERNAL_ERROR - Invalid 2FA token","request_id":"60ba8054-abcb-4c46-afb4-94137f5498a7","status":400,"timestamp":"2025-09-30 21:41:56"}
{"details":null,"level":"error","message":"API Error: INTERNAL_ERROR - Invalid 2FA token","request_id":"fc435a6e-7475-4d3a-9b68-1528e941b5bb","status":400,"timestamp":"2025-09-30 21:42:23"}
{"details":null,"level":"error","message":"API Error: INTERNAL_ERROR - Invalid 2FA token","request_id":"22dbdf00-63f7-4ff0-aa2b-3c03adf5b46d","status":400,"timestamp":"2025-09-30 21:45:11"}
